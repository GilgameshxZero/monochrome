"use strict";{const e=self,t=e,n=e.document,o=n.documentElement,s=o.classList;(self.webpackChunkStylus=self.webpackChunkStylus||[]).push([["common-ui"],{1949:(e,s,i)=>{var a=i(7986),r=i(3831),c=i(3619),l=i(492),d=i(1480);const onDarkChanged=new Set,MEDIA_ON="screen",MEDIA_OFF="not all",MEDIA_NAME="dark",map={[MEDIA_ON]:!0,[MEDIA_OFF]:!1};let isDark;function updateDOM(){o.dataset.uiTheme=isDark?"dark":"light",r.getCssMediaRuleByName(MEDIA_NAME,e=>{map[e[0]]!==isDark&&(e.mediaText=`${isDark?MEDIA_ON:MEDIA_OFF},${MEDIA_NAME}`)});for(const e of onDarkChanged)e(isDark)}(async()=>{let favicon;t===top?({dark:isDark,favicon}=l.clientData):isDark="dark"===parent.document.documentElement.dataset.uiTheme,updateDOM(),c.onMessage.set(e=>{"colorScheme"===e.method&&isDark!==e.value&&(isDark=e.value,updateDOM())}),favicon&&t===top&&"/popup.html"!==location.pathname&&n.head.append(...[32,16].map(size=>a.$create("link",{rel:"icon",href:`${d.MF_ICON_PATH}${isDark?"":"light/"}${size}${d.MF_ICON_EXT}`,sizes:size+"x"+size})))})(),s.MEDIA_OFF=MEDIA_OFF,s.MEDIA_ON=MEDIA_ON,s.onDarkChanged=onDarkChanged,i.d(s,{isDark:()=>isDark})},3831:(e,o,s)=>{o.animateElement=function(e,cls="highlight",...removeExtraClasses){return e?new Promise(resolve=>{let onDone=()=>{e.classList.remove(cls,...removeExtraClasses),onDone=null,resolve()};requestAnimationFrame(()=>{if(onDone){const style=getComputedStyle(e);"none"!==style.animationName&&parseFloat(style.animationDuration)||(e.off("animationend",onDone),onDone())}}),e.on("animationend",onDone,{once:!0}),e.classList.add(cls)}):Promise.resolve(e)},o.getCssMediaRuleByName=function(name,e){for(const sheet of n.styleSheets)for(const{media:t}of sheet.cssRules)if(t&&t[1]===name&&!1===e(t))return},o.getEventKeyName=function(e,letterAsCode){const mods=(e.shiftKey?"Shift-":"")+(e.ctrlKey?"Ctrl-":"")+(e.altKey?"Alt-":"")+(e.metaKey?"Meta-":"");return`${mods===e.key+"-"?"":mods}${e.key?!e.key[1]&&letterAsCode?e.code:e.key[1]?e.key:e.key.toUpperCase():"Mouse"+("LMR"[e.button]||e.button)}`},o.important=function(str){return str.replace(/;/g,"!important;")},o.moveFocus=function(rootElement,step){const elements=[...rootElement.getElementsByTagName("*")],activeEl=n.activeElement,activeIndex=step?Math.max(step<0?0:-1,elements.indexOf(activeEl)):-1,num=elements.length;step||(step=1);for(let e=1;e<=num;e++){const t=elements[(activeIndex+e*step+num)%num];if(!t.disabled&&t.tabIndex>=0&&t.getBoundingClientRect().width)return t.focus(),setHocus(t,lastHocus),activeEl!==t&&t}},o.scrollElementIntoView=function(element,{invalidMarginRatio=0}={}){if(!element.parentNode)return;const{top,height}=element.getBoundingClientRect(),{top:parentTop,bottom:parentBottom}=element.parentNode.getBoundingClientRect(),windowHeight=t.innerHeight;if(top<Math.max(parentTop,windowHeight*invalidMarginRatio)||top>Math.min(parentBottom,windowHeight)-height-windowHeight*invalidMarginRatio){const scroller=element.closest(".scroller")||t;scroller.scrollBy(0,top-(scroller.clientHeight||windowHeight)/2+height)}},o.setInputValue=function(input,value){input.focus(),input.select(),n.execCommand(value?"insertText":"delete",!1,value),input.value!==value&&(input.value=value,input.dispatchEvent(new Event("input",{bubbles:!0})))},o.setupLivePrefs=function(ids){let init=!0;const all=(ids instanceof Element?ids:n).getElementsByTagName("*");function onChange(){this.checkValidity()&&("radio"!==this.type||this.checked)&&a.set(this.id||this.name,getValue(this))}function getValue(e){const type=e.dataset.valueType||e.type;return"checkbox"===type?e.checked:"number"===type?parseFloat(e.value):e.value}function isSame(e,oldValue,value){return"radio"===e.type?e.checked===(oldValue===value):"select"===e.localName&&"boolean"==typeof value&&oldValue===`${value}`||oldValue===value}ids=ids?.forEach?[...ids]:a.knownKeys.filter(e=>e in all),a.subscribe(ids,function updateElement(e,value){const byId=all[e],els=byId&&byId.id?[byId]:n.getElementsByName(e);if(els[0])for(const e of els){const oldValue=getValue(e),diff=!isSame(e,oldValue,value),type=e.type;"select-one"===type&&!i.cssFieldSizing&&(init||diff)&&e.classList.contains("fit-width")?fitSelectBox(e,value,init):diff&&("radio"===type?e.checked=value===oldValue:"checkbox"===type?e.checked=value:e.value=value,e.dispatchEvent(new Event("change",{bubbles:!0}))),init&&e.on("change",onChange)}else a.unsubscribe(e,updateElement)},!0),init=!1},o.showSpinner=function(parent){return(parent=parent instanceof Node?parent:n.querySelector(parent)).appendChild(i.$create(".lds-spinner",new Array(12).fill(i.$create("div")).map(e=>e.cloneNode())))};s(6940);var i=s(7986),a=s(492);let configDialog=async(...args)=>(configDialog=(await s.e("js_dlg_config-dialog_js").then(s.bind(s,4429))).default)(...args),messageBox=new Proxy({},{get:(e,key)=>async(...args)=>(messageBox=await s.e("js_dlg_message-box_js").then(s.bind(s,7239)))[key](...args)}),lastHocus=!1;const setHocus=(e,state)=>e&&i.$toggleDataset(e,"focusedViaClick",state);o.closestFocusable=e=>{let labelSeen;for(;e;e=e.parentElement)if("label"===e.localName&&e.control&&!labelSeen&&(e=e.control,labelSeen=!0),e.tabIndex>=0)return e},o.closestHocused=e=>e?.closest("[data-focused-via-click]"),o.isHocused=e=>e&&"focusedViaClick"in e.dataset,o.setHocus=setHocus,o.setLastHocus=(e,state)=>e&&i.$toggleDataset(e,"focusedViaClick",lastHocus=state),s.d(o,{configDialog:()=>configDialog,messageBox:()=>messageBox})},7501:(e,t,o)=>{t.formatDate=function(date,needsTime){if(!date)return"";try{const now=new Date,newDate=new Date(Number(date)||date),needsYear=newDate.getYear()!==now.getYear(),needsWeekDay=needsTime&&now-newDate<=6048e5,intlKey=(needsWeekDay?"W":"")+(needsYear?"Y":"")+(needsTime?"HM":""),string=(intlCache[intlKey]||(intlCache[intlKey]=new Intl.DateTimeFormat([chrome.i18n.getUILanguage(),"en"],{day:"numeric",month:"short",year:needsTime?"numeric":needsYear?"2-digit":void 0,hour:needsTime?"numeric":void 0,minute:needsTime?"2-digit":void 0,weekday:needsWeekDay?"long":void 0}))).format(newDate);return"Invalid Date"===string?"":string}catch{return""}},t.formatRelativeDate=function(date,style){let delta=(Date.now()-date)/1e3;if(delta>=0&&Intl.RelativeTimeFormat)for(const[span,unit,frac]of RELATIVE_UNITS){if(delta<span)return(intlCache.R||(intlCache.R=new Intl.RelativeTimeFormat([chrome.i18n.getUILanguage(),"en"],{style}))).format(-delta.toFixed(frac),unit);delta/=span}return""},t.htmlToTemplate=function(html){const e=parseHtml(html).body,first=e.firstChild,res=first.nextSibling?s.$createFragment(e.childNodes):first;return tElements(res),res},t.htmlToTemplateCache=function(html){for(const e of parseHtml(html).$$("template[data-id]"))createTemplate(e);return templateCache},t.tBody=function(e){if(e)onBodyListeners?onBodyListeners.push(e):e();else{tElements(n);const tpl=template.body;for(e of(tpl&&tpl!==n.body&&(template.body=n.body).append(tpl),onBodyListeners))e();onBodyListeners=void 0}};var s=o(7986),i=o(6940);const templateCache={},template=new Proxy(templateCache,{get:(obj,e)=>obj[e]||createTemplate(n.querySelector(`template[data-id="${e}"]`))}),ALLOWED_TAGS=["a","b","br","code","i","hr","nobr","small","sub","sup","wbr"],RX_WORD_BREAK=/([\w{-\uFFFF]{10}|[\w{-\uFFFF]{5,10}[!'")*,./]|((?!\s)\W){10})(?!\s|$)/gu,SELECTOR="[i18n]",RELATIVE_UNITS=[[60,"second",0],[60,"minute",0],[24,"hour",1],[7,"day",1],[4,"week",1],[12,"month",1],[1e99,"year",1]],intlCache={},breakWord=text=>text.length<=10?text:text.replace(RX_WORD_BREAK,"$&­"),parseHtml=str=>(new DOMParser).parseFromString(str,"text/html");let onBodyListeners=[];function tElements(elems){for(const e of elems.$$?elems.tagName?[elems,...elems.$$(SELECTOR)]:elems.$$(SELECTOR):elems){const attr=e.getAttribute("i18n");if(attr){for(let item of attr.split(",")){item=item.trim();const add=43===item.charCodeAt(0),t=add?"append":"prepend",n=item.indexOf(":"),key=n>0&&item.slice(add,n),val=i.t(n>0?item.slice(n+1).trim():add?item.slice(1):item);key?"html"===key?e[t](...sanitizeHtml(val)):e.setAttribute(key,breakWord(val)):e[t](breakWord(val))}e.removeAttribute("i18n")}}}function createTemplate(e){if(!e)return;const{content=e,dataset:{id:t}={}}=e,first=content.firstChild,res=first.nextSibling?content:first;return t&&(templateCache[t]=res),tElements(res),res}function sanitizeHtml(str){const root=parseHtml(str).body,toRemove=[],walker=n.createTreeWalker(root);for(let e,t,n;e=walker.nextNode();)if(3===e.nodeType)(n=e.parentNode)&&"NOBR"!==(n=n.tagName)&&"PRE"!==n&&"CODE"!==n&&(n=breakWord(t=e.nodeValue))!==t&&(e.nodeValue=n);else if(ALLOWED_TAGS.includes(e.localName)){const isA="a"===e.localName;for(const attr of e.attributes)isA&&"href"===attr.localName&&/^https?:/.test(e.href)||e.removeAttribute(attr.name);isA&&(e.target="_blank",e.rel="noreferrer")}else toRemove.push(e);for(const e of toRemove)e.parentNode?.removeChild(e);return root.childNodes}t.breakWord=breakWord,t.tHTML=html=>"string"!=typeof html?html:/<\w+/.test(html)?s.$createFragment(sanitizeHtml(html)):n.createTextNode(html),t.template=template,t.templateCache=templateCache,o.d(t,{})},7986:(e,t,o)=>{t.$$remove=function(selector,base=n){for(const e of base.$$(selector))e.remove()},t.$create=s,t.$createFragment=function(nodes){const bin=n.createDocumentFragment();return bin.append(...nodes),bin},t.$createLink=function(href,content){const opt={target:"_blank",rel:"noopener"};href&&("string"==typeof href?opt.href=href:Object.assign(opt,href));return s("a",opt,content)},t.$detach=function(e,state=!0){let cmt=detachments.get(e);state??=!cmt,state?cmt||(cmt=n.createComment((cmt=e.id)?"#"+cmt:(cmt=e.className)?"."+cmt:e.outerHTML),detachments.set(e,cmt),e.replaceWith(cmt)):cmt&&(cmt.replaceWith(e),detachments.delete(e));return state},t.$toggleClasses=function(e,newClasses){const list=new Set(e.className.split(/\s+/));for(const e in newClasses)newClasses[e]?list.add(e):list.delete(e);const res=[...list].join(" ");res!==e.className&&(e.className=res)},t.$toggleDataset=function(e,prop,state){if(!e)return;const t=e.dataset,wasEnabled=null!=t[prop];state?wasEnabled||(t[prop]="string"==typeof state?state:""):wasEnabled&&delete t[prop]},Object.assign(EventTarget.prototype,{on:addEventListener,off:removeEventListener});for(const{prototype}of[Document,DocumentFragment,Element])prototype.$=prototype.querySelector,prototype.$$=prototype.querySelectorAll;const detachments=new WeakMap,getObjectType=Object.call.bind({}.toString);function s(selector,props,guts){let e;if(/\W/.test(selector)){const tica=selector.split("["),tic=tica[0].split("."),t=tic[0].split("#");e=n.createElement(t[0]||"div"),t[1]&&(e.id=t[1]),tic.length>1&&(e.className=tic.length>2?tic.slice(1).join(" "):tic[1]);for(let t,n=1;t=tica[n++];)e.setAttribute((t=t.split("]")[0].split("="))[0],t[1]||"")}else e=n.createElement(selector);if("[object Object]"===getObjectType(props)){const{on:t}=props;if(t)for(const n in t)e.on(n,t[n]);Object.assign(e,props),t&&delete e.on}else null!=props&&(guts=props);return null!=guts&&("string"==typeof guts?e.textContent=guts:Array.isArray(guts)?e.append(...guts):guts instanceof Node&&e.appendChild(guts)),e}t.$isTextInput=({localName,type}={})=>"textarea"===localName||"input"===localName&&("text"===type||"search"===type||"number"===type||"url"===type),t.cssFieldSizing=true,t.dom={}},9073:(i,a,r)=>{var dom=r(7986),dom_util=r(3831),localization=r(7501),prefs=r(492),c=r(8970),msg=(r(6990),r(1949),r(1480),r(3619)),msg_api=r(4930);const CLASS="stylus",PREFIX=CLASS+"-",MEDIA="screen, "+PREFIX,kAss="adoptedStyleSheets",own={cfg:{off:!1,top:""}},runtime=chrome.runtime,wrappedDoc=n,ORDERED_TAGS=new Set(["head","body","frameset",!1,"link"]),docRootObserver=function(onChange){let observing=!1;const observer=new MutationObserver(onChange);return{start,stop,restart:function(){observing&&(stop(),start())}};function start(){observing||ass||(observer.observe(root,{childList:!0}),observing=!0)}function stop(){observing&&(observer.disconnect(),observing=!1)}}(restoreOrder),toSafeChar=e=>String.fromCharCode(65280+e.charCodeAt(0)-32),list=[],randomIds={},calcOrder=({id:e})=>1e6*orderPrio[e]||orderMain[e]||e+5e5,compare=(e,t)=>calcOrder(e)-calcOrder(t),table=new Map;let ass,assV2,assIndexOf,isTransitionPatched,exposeStyleName,ffCsp,creationDoc,createElement,createElementNS,orderPrio,orderMain,onInjectorUpdate,selfDestruct,root=n.documentElement,isEnabled=!0,nonce="",reorderCnt=0,reorderStart=0;function removeId(e){removeStyle(table.get(e))&&emitUpdate()}function toggle(enable){isEnabled!==(enable=!!enable)&&(isEnabled=enable,enable?addAllElements():removeAllElements())}function addElement(e,before){if(ass){const sheets=assV2||wrappedDoc[kAss].slice();let t=assIndexOf(sheets,e);t>=0&&(e=sheets.splice(t,1)[0]),t=before?assIndexOf(sheets,before):-1,t>=0?sheets.splice(t,0,e):sheets.push(e),assV2||(wrappedDoc[kAss]=sheets)}else updateRoot().insertBefore(e,before);return e}function addAllElements(){list.length&&(toggleObservers(!1),ass?replaceAss(!0):updateRoot().append(...list.map(e=>e.el)),toggleObservers(!0))}function removeElement(e){if(e.remove)e.remove();else if(ass){const sheets=assV2||wrappedDoc[kAss].slice(),t=assIndexOf(sheets,e);t>=0&&(sheets.splice(t,1),assV2||(wrappedDoc[kAss]=sheets))}}function removeAllElements(){if(toggleObservers(!1),ass)replaceAss();else for(const{el:e}of list)removeElement(e)}function replaceAss(readd){const elems=list.map(e=>e.el),res=[];for(let e,arr=assV2||wrappedDoc[kAss],t=0;t<arr.length&&(e=arr[t]);t++)assIndexOf(elems,e)<0&&res.push(e);readd&&res.push(...elems),wrappedDoc[kAss]=res}function apply({cfg,sections},isReplace){cfg&&updateConfig(cfg);const ids=isReplace&&new Set;for(const style of sections){const{id:e,code}=style,codeStr=Array.isArray(code)?style.code=code.join(""):code,old=table.get(e);if(old)(old.code!==codeStr||exposeStyleName&&old.name!==style.name)&&(old.code=codeStr,setTextAndName(old.el,style),old.el.disabled=!1);else{style.el=createStyle(style),table.set(e,style);const t=list.findIndex(item=>calcOrder(item)>calcOrder(style));list.splice(t<0?list.length:t,0,style)}isReplace&&ids.add(e)}if(toggleObservers(!1),isReplace&&list.length>ids.size)for(let e,t=list.length;--t>=0;)ids.has((e=list[t]).id)||removeStyle(e);isEnabled&&(isTransitionPatched||applyTransitionPatch(sections),restoreOrder()),emitUpdate()}function applyTransitionPatch(styles){if(isTransitionPatched=!0,"complete"===n.readyState||"hidden"===n.visibilityState||!styles.some(e=>e.code.includes("transition")))return;const e=createStyle({id:"transition-patch",code:":not(#\\0):not(#\\0) { transition: none !important }"});addElement(e),requestAnimationFrame(()=>setTimeout(removeElement,0,e))}function createStyle(style){let e,{id:t}=style;if(ass){exposeStyleName||(t=randomIds[t]??=Math.random().toString(36).slice(2)),t=MEDIA+t,e=new CSSStyleSheet({media:t}),setTextAndName(e,style);for(let e,arr=assV2||wrappedDoc[kAss],n=0;n<arr.length;n++)(e=arr[n].media).mediaText===t&&(e.mediaText+="-old");return e}return!creationDoc&&(e=initCreationDoc(style))||(e=createElement("style"),nonce&&(e.nonce=nonce),t&&exposeStyleName&&(t=e.id=`${PREFIX}${t}`),e.classList.add(CLASS),setTextAndName(e,style)),e}function setTextAndName(e,{id:n,code,name}){if(ass)try{e.replaceSync(code)}catch{e.replace(code)}else exposeStyleName&&name&&(e.dataset.name!==name&&(e.dataset.name=name),name=encodeURIComponent(name.replace(/[?#/']/g,toSafeChar)),code+=`\n/*# sourceURL=${runtime.getURL(name)}.user.css#${n}${t!==top?"#"+Math.random().toString(36).slice(2):""} */`),(e.firstChild||e).textContent=code}function toggleObservers(shouldStart){if(ass&&shouldStart)return;const onOff=shouldStart&&isEnabled?"start":"stop";docRootObserver[onOff]()}function emitUpdate(){toggleObservers(list.length),onInjectorUpdate()}function initAss(){assIndexOf||(Object.isExtensible(ass)&&(assV2=ass),assIndexOf=Object.call.bind([].indexOf))}function initCreationDoc(style){creationDoc=wrappedDoc;for(let e,retry=0;!e&&retry<2;retry++)return createElement=creationDoc.createElement.bind(creationDoc),void(createElementNS=creationDoc.createElementNS.bind(creationDoc))}function removeStyle(style){if(style)return table.delete(style.id),list.splice(list.indexOf(style),1),removeElement(style.el),!0}function restoreOrder(mutations){if(!runtime.id)return selfDestruct();let bad,e=list.length&&list[0].el;if(e)if(ass){assV2||(ass=wrappedDoc[kAss]);for(let len=list.length,base=ass.length-len,e=0;e<len;e++)if(base<0||ass[base+e]!==list[e].el){bad=!0;break}}else if(e.parentNode!==creationDoc.documentElement)bad=!0;else{let t=0;for(;e;){if(t<list.length&&e===list[t].el)t++;else if(ORDERED_TAGS.has(e.localName)){bad=!0;break}e=e.nextElementSibling}t<list.length&&(bad=!0)}else bad=!1;if(!bad)return;!mutations||++reorderCnt<10?addAllElements():console.debug("Stylus ignored wrong order of styles to avoid an infinite loop of mutations.");const t=performance.now();t-reorderStart>250&&(reorderCnt=0,reorderStart=t)}function sort(){list.sort(compare),isEnabled&&addAllElements()}function updateConfig(cfg){if(exposeStyleName=cfg.name,nonce=cfg.nonce||nonce,ffCsp=!nonce&&!1,({main:orderMain={},prio:orderPrio={}}=cfg.order||{}),!ass!=!cfg.ass){removeAllElements(),ass=ass?null:wrappedDoc[kAss],ass&&initAss();for(const e of list)e.el=createStyle(e);addAllElements()}}function updateRoot(){return runtime.id?(root!==n.documentElement&&(root=n.documentElement,addAllElements(),docRootObserver.restart()),root):selfDestruct()}const SYM_ID="styles",kPageShow="pageshow",clone=e._deepCopy;let isFrameSameOrigin=!1;if(msg_api.isFrame)try{isFrameSameOrigin=Object.getOwnPropertyDescriptor(parent.location,"href"),isFrameSameOrigin=!!isFrameSameOrigin?.get}catch{}const isFrameNoUrl=isFrameSameOrigin&&"about:"===location.protocol,xoEventId=`${Math.random()}`,NAV_ID="url:"+runtime.id,navHub=e[NAV_ID]=new EventTarget,navHubParent=isFrameNoUrl&&parent[NAV_ID]||null;let mqDark,offscreen,port,throttled,throttledCount,l,mqCompact,matchUrl=isFrameNoUrl?parent.location.href.split("#")[0]:location.href,lazyBadge=msg_api.isFrame;async function init(){let data;if((data=e.clientData)?data=data.apply:(data=isFrameNoUrl&&clone(parent[parent.Symbol.for(SYM_ID)]),data?await new Promise(onFrameElementInView):data=!1),!runtime.id)return apply_selfDestruct();await applyStyles(data,!0)}async function applyStyles(data,isInitial=!own.sections){data||(data=await getStyles({init:isInitial})),data.cfg||(data.cfg=own.cfg),Object.assign(own,e[Symbol.for(SYM_ID)]=data),msg_api.isFrame||""!==own.cfg.topUrl||(own.cfg.topUrl=location.origin),list.length?apply(own,!0):own.cfg.off||apply(own),toggle(!own.cfg.off)}function getStyles(opts){return msg_api.isFrame||(opts.dark=(mqDark??(mqDark=matchMedia("(prefers-color-scheme: dark)"),isFrameSameOrigin||(mqDark.onchange=({matches:e})=>{e!==own.cfg.dark&&msg_api.API.setSystemDark(own.cfg.dark=e)}),mqDark)).matches),msg_api.API.styles.getSectionsByUrl(matchUrl,opts)}function applyOnMessage(req,sender,multi){if(multi)return throttled??=Promise.resolve().then(processThrottled)&&[],void throttled.push(req);const{style}=req;switch(req.method){case"ping":return!0;case"styleDeleted":removeId(style.id);break;case"styleUpdated":if(!own.sections&&own.cfg.off)break;style.enabled?getStyles({id:style.id}).then(res=>res.sections.length?apply(res):removeId(style.id)):removeId(style.id);break;case"styleAdded":!own.sections&&own.cfg.off||!style.enabled||getStyles({id:style.id}).then(apply);break;case"urlChanged":0===req.iid&&updateUrl(req.url);break;case"injectorConfig":apply_updateConfig(req);break;case"backgroundReady":return own.sections&&updateCount(),!0}}function processThrottled(){for(const req of throttled)applyOnMessage(req);throttled=null,updateCount()}function apply_updateConfig({cfg}){for(const e in cfg){const t=cfg[e];t!==own.cfg[e]&&((msg_api.isFrame||"top"!==e&&"topUrl"!==e)&&(own.cfg[e]=t,"off"===e?updateDisableAll():"order"===e?sort():"top"===e?updateExposeIframes():"wake"===e?updatePort():updateConfig(own.cfg)))}}function updateDisableAll(){own.sections||own.cfg.off?toggle(!own.cfg.off):offscreen||init()}function updateExposeIframes(){const attr="stylus-iframe",e=n.documentElement;e&&(own.cfg.top&&list.length?e.getAttribute(attr)!==own.cfg.topUrl&&e.setAttribute(attr,own.cfg.topUrl):e.hasAttribute(attr)&&e.removeAttribute(attr))}function updateCount(){let ids,str;msg_api.TDM<0||(msg_api.isFrame&&lazyBadge&&performance.now()>1e3&&(lazyBadge=!1),throttled||throttledCount===(str=(ids=[...table.keys()]).join(","))||(msg_api.API.updateIconBadge(ids,lazyBadge,0),throttledCount=str))}function updatePort(){own.cfg.wake||list.length?port||!msg_api.isFrame&&!own.cfg.wake||(port=runtime.connect({name:"apply"}),port.onDisconnect.addListener(onPortDisconnected)):(port?.disconnect(),port=null)}function updateUrl(url){url!==matchUrl&&(matchUrl=url,own.sections&&applyStyles(own.cfg.off&&{}),navHub.dispatchEvent(new Event(NAV_ID)))}function onFrameElementInView(e){parent[parent.Symbol.for("xo")](frameElement,e),(offscreen??=[]).push(e)}function onIntersect(entries){if(!runtime.id)return apply_selfDestruct();for(const e of entries)e.intersectionRatio&&(l.unobserve(e.target),e.target.dispatchEvent(new Event(xoEventId)))}function onBFCache(e){if(!runtime.id)return apply_selfDestruct();e.isTrusted&&e.persisted&&(throttledCount="",init())}function onPortDisconnected(){own.cfg.wake&&addEventListener("mousedown",wakeUpSW,!0),port=null}function wakeUpSW(e){if(!runtime.id)return apply_selfDestruct();!port&&e.target.closest("a")?.href&&updatePort()}function onUrlChanged(){updateUrl(parent.location.href)}function apply_selfDestruct(){if(removeEventListener(kPageShow,onBFCache),mqDark&&(mqDark=mqDark.onchange=null),offscreen)for(const e of offscreen)e();msg_api.TDM<0&&(n.onprerenderingchange=null),removeEventListener("mousedown",wakeUpSW,!0),navHubParent?.removeEventListener(NAV_ID,onUrlChanged,!0),offscreen=null,list.length&&(toggleObservers(!1),removeAllElements(),list.length=0,table.clear()),msg.onMessage.delete(applyOnMessage),port?.disconnect()}if(e[Symbol.for("xo")]=(e,t)=>{l||(l=new IntersectionObserver(onIntersect,{rootMargin:"100%"})),e.addEventListener(xoEventId,t,{once:!0}),l.observe(e)},navHubParent?.addEventListener(NAV_ID,onUrlChanged,!0),msg_api.TDM<0&&(n.onprerenderingchange=function(e){if(!runtime.id)return apply_selfDestruct();e.isTrusted&&(msg_api.updateTDM(2),n.onprerenderingchange=null,getStyles({init:"cfg"}).then(apply_updateConfig),updateCount())}),onInjectorUpdate=()=>{updateCount(),msg_api.isFrame&&updateExposeIframes(),(msg_api.isFrame||own.cfg.wake)&&updatePort()},selfDestruct=apply_selfDestruct,init(),msg.onMessage.set(applyOnMessage,!0),addEventListener(kPageShow,onBFCache),prefs.subscribe("disableAll",(e,val)=>{s.toggle("all-disabled",val)},!0),o.classList.add("mv3",c.MOBILE?"mobile":"desktop",c.WINDOWS?"windows":"non-windows",c.FIREFOX?"firefox":"chromium",...c.OPERA?["opera"]:c.VIVALDI?["vivaldi"]:[]),o.lang=chrome.i18n.getUILanguage(),s.contains("normal-layout")){let e;const listeners=new Set,toggleCompact=function({matches:val}){dom.$toggleClasses(o,{"compact-layout":val,"normal-layout":!val});for(const e of listeners)e(val)};mqCompact=t=>{listeners.add(t),e&&t(e.matches)},prefs.subscribe("compactWidth",(t,val)=>{e=matchMedia(`(max-width: ${val}px)`),(e.onchange=toggleCompact)(e),dom_util.getCssMediaRuleByName("compact",e=>{t=e.mediaText.replace(/\d+/,val),e.mediaText!==t&&(e.mediaText=t)})},!0)}{const e="headerWidth.",HWprefId=e+location.pathname.match(/^.(\w*)/)[1];prefs.knownKeys.includes(HWprefId)&&(Object.assign(dom.dom,{HW:e,HWprefId,setHWProp(width){const max=(innerWidth<850?screen.availWidth:innerWidth)/3;return width=Math.round(Math.max(200,Math.min(max,Number(width)||0))),o.style.setProperty("--header-width",width+"px"),dom.dom.HWval=width,width}}),prefs.ready.then(()=>dom.dom.setHWProp(prefs.__values[HWprefId]))),t.on("load",()=>r.e("common-ui").then(r.bind(r,9539)),{once:!0})}prefs.ready.then(()=>localization.tBody(()=>{const e=new MutationObserver(function([{target:e}]){canSave(e)&&prefs.set(e.dataset.pref,e.open)}),moCfg={attributes:!0,attributeFilter:["open"]},SEL="details[data-pref]";for(const t of n.querySelectorAll(SEL))prefs.subscribe(t.dataset.pref,updateOnPrefChange,!0),e.observe(t,moCfg);function canSave(e){return!e.matches(".ignore-pref, .compact-layout .ignore-pref-if-compact")}function updateOnPrefChange(key,value){const e=n.querySelector(`details[data-pref="${key}"]`);e.open!==value&&canSave(e)&&(e.open=value)}mqCompact?.(val=>{for(const e of n.querySelectorAll(SEL))e.matches(".ignore-pref")||(e.open=(!val||!e.classList.contains("ignore-pref-if-compact"))&&prefs.__values[e.dataset.pref])})})),r.d(a,{mqCompact:()=>mqCompact})},9539:(e,o,s)=>{var dom=s(7986),dom_util=s(3831),prefs=s(492);var localization=s(7501),msg=s(3619),i=s(8970),urls=s(8982),util=s(6940);const SPLIT_BTN_MENU=".split-btn-menu",tooltips=new WeakMap;if(function(){for(const e of n.querySelectorAll("[title]")){if(tooltips.has(e))continue;const old=e.title,title=old.replace(/(\n\s*)?<\/?[a-z]+[^>]*>(\n\s*)?/g," ");tooltips.set(e,old);let tmp="";if(title.length<50)tmp=title;else for(const e of title.split(/\n+/))tmp+=e.replace(/([.?!]\s+|[．。？！]\s*|.{50,60},)\s+/gu,"$1\n").replace(/(.{50,80}(?=.{40,}))\s+/gu,"$1\n"),tmp+="\n\n";tmp!==old&&(e.title=tmp)}}(),addTooltipsToEllipsized(),t.on("mousedown",function({target}){dom_util.setLastHocus(dom_util.closestFocusable(target),!0)},{passive:!0}),t.on("keydown",function(event){"Tab"!==event.key||event.ctrlKey||event.altKey||event.metaKey||(dom_util.setLastHocus(!1),setTimeout(()=>dom_util.setHocus(dom_util.closestHocused(n.activeElement),!1)))},{passive:!0}),t.on("keypress",function(e){if("Enter"===dom_util.getEventKeyName(e)){const t=e.target.closest("a");t&&!t.href&&0===t.tabIndex&&t.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}}),t.on("wheel",function(event){const e=n.activeElement;if(!e||e!==event.target&&!e.contains(event.target))return;const isSelect="SELECT"===e.tagName;if(isSelect||"INPUT"===e.tagName&&"range"===e.type){const key=isSelect?"selectedIndex":"valueAsNumber",old=e[key],rawVal=old+Math.sign(event.deltaY)*(e.step||1);e[key]=util.clamp(rawVal,e.min||0,e.max||e.length-1),e[key]!==old&&e.dispatchEvent(new Event("change",{bubbles:!0})),event.preventDefault()}event.stopImmediatePropagation()},{capture:!0,passive:!1}),t.on("click",splitMenu),t.on("click",function(event){let note=event.target.closest("[data-cmd=note]");note&&(event.preventDefault(),note=tooltips.get(note)||note.title,dom_util.messageBox.show({className:"note center-dialog",contents:note.includes("<")?localization.tHTML(note):note.includes("\n")?dom.$create("div",note.split("\n").map(line=>dom.$create("p",line))):note,buttons:[util.t("confirmClose")]}))},!0),t.on("resize",()=>util.debounce(addTooltipsToEllipsized,100)),msg.onMessage.set(request=>{"editDeleteText"===request.method&&n.execCommand("delete")}),!i.CHROME||i.CHROME<93)e:for(const sheet of n.styleSheets)for(let rule,e=0;rule=sheet.cssRules[e];e++)if(/#\\1\s?transition-suppressor/.test(rule.cssText)){sheet.deleteRule(e);break e}const elOff=n.getElementById("disableAll-label");elOff&&prefs.subscribe("disableAll",()=>elOff.dataset.persist=""),n.getElementById("header")&&function(){let offset,perPage,curW=n.getElementById("header").offsetWidth;function resize(e){setWidth(offset+e.clientX)}function resizeStop(){n.off("mouseup",resizeStop),n.off("mousemove",resize),n.body.classList.remove("resizing-h"),save()}function save(){if(perPage)prefs.set(dom.dom.HWprefId,curW);else for(const e of prefs.knownKeys)e.startsWith(dom.dom.HW)&&prefs.set(e,curW)}function setWidth(e){const delta=(e=dom.dom.setHWProp(e))-curW;if(delta){curW=e;for(const e of n.querySelectorAll('.CodeMirror-linewidget[style*="width:"]'))e.style.width=parseFloat(e.style.width)-delta+"px"}}prefs.subscribe(dom.dom.HWprefId,(key,val)=>setWidth(val)),n.getElementById("header-resizer").onmousedown=e=>{e.button||(offset=curW-e.clientX,perPage=e.shiftKey,n.body.classList.add("resizing-h"),n.on("mousemove",resize),n.on("mouseup",resizeStop))}}();const getFSH=DataTransferItem.prototype.getAsFileSystemHandle;function addTooltipsToEllipsized(){const e=new IntersectionObserver(entries=>{for(const e of entries){const btn=e.target,t=e.boundingClientRect.width;if(t&&btn.preresizeClientWidth!==t)if(btn.preresizeClientWidth=t,btn.scrollWidth>t){const text=btn.textContent;btn.title=text.includes("­")?text.replace(/\u00AD/g,""):text,btn.titleIsForEllipsis=!0}else btn.title&&(btn.title="")}e.disconnect()});for(const t of n.querySelectorAll("button, h2"))t.title&&!t.titleIsForEllipsis||e.observe(t)}function splitMenu(event){const prevMenu=n.querySelector(".split-btn.active "+SPLIT_BTN_MENU)||n.querySelector(SPLIT_BTN_MENU),prevPedal=prevMenu?.previousElementSibling,pedal=event&&event.target.closest(".split-btn-pedal"),entry=event&&prevMenu&&event.target.closest(SPLIT_BTN_MENU+">*");if(prevMenu&&(prevMenu.onfocusout=null,prevMenu.remove(),prevPedal.parentElement.classList.remove("active"),t.off("keydown",splitMenuEscape),event||prevPedal.focus()),pedal&&pedal!==prevPedal){const menu=dom.$create(SPLIT_BTN_MENU,{style:"opacity:0"},Array.from(pedal.attributes,({name,value})=>name.startsWith("menu-")&&dom.$create("a",{tabIndex:0,__cmd:name.split("-").pop()},value)).filter(Boolean)),wrapper=pedal.parentElement,e=new IntersectionObserver(splitMenuIntersect);t.on("keydown",splitMenuEscape),menu.onfocusout=e=>{menu.contains(e.relatedTarget)||setTimeout(splitMenu)},pedal.on("mousedown",e=>e.preventDefault()),wrapper.classList.toggle("active"),pedal.after(menu),dom_util.moveFocus(menu,0),dom_util.setHocus(menu.firstChild,dom_util.isHocused(pedal)),e.observe(menu)}entry&&prevPedal.previousElementSibling.dispatchEvent(new CustomEvent("split-btn",{detail:entry.__cmd,bubbles:!0}))}function splitMenuEscape(e){"Escape"===dom_util.getEventKeyName(e)&&(e.preventDefault(),splitMenu())}function splitMenuIntersect(entries,observer){observer.disconnect();const menu=entries[0].target;let e,t,width=1e6;for({intersectionRect:t}of entries)width=Math.min(width,t.width-(null!=e?e:(e=t.x,0)));e=width-entries[0].boundingClientRect.width,e<0&&(menu.style.transform=`translateX(calc(${e}px - var(--menu-pad)))`),menu.style.opacity=""}getFSH&&(addEventListener("dragover",e=>{e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation())},!0),addEventListener("drop",async e=>{const n=e.dataTransfer,file=n.files[0];if(!file||!/\.(css|styl|less)$/i.test(file.name))return;e.preventDefault(),e.stopPropagation();const path=urls.installUsercss,url=util.tryURL(n.getData("text")).href,handle=await getFSH.call([].find.call(n.items,e=>"file"===e.kind)),wnd=t.open(path),{structuredClone}=wnd;(wnd.fsh=structuredClone?structuredClone(handle):handle)._url=url},!0))}}])}