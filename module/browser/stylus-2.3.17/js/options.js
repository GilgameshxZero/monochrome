"use strict";{const e=self,t=e,n=e.document,o=n.documentElement;(self.webpackChunkStylus=self.webpackChunkStylus||[]).push([["options"],{9132:(e,s,c)=>{c(9073),c(9458);var dom=c(7986),dom_util=c(3831),localization=c(7501),msg_api=c(4930),prefs=c(492),a=c(8970),util=c(6940),msg=(c(1480),c(3619)),sync_util=c(4188);(async()=>{let{sync:status,syncOpts}=prefs.clientData;const elSync=localization.template.body.$(".sync-options"),elCloud=elSync.$(".cloud-name"),elToggle=elSync.$(".connect"),elSyncNow=elSync.$(".sync-now"),elStatus=elSync.$(".sync-status"),elLogin=elSync.$(".sync-login"),elDriveOptions=elSync.$$(".drive-options"),e=()=>elSync.$$(`[data-drive="${elCloud.value}"] [data-option]`);function getDriveOptions(){const result={};for(const t of e())result[t.dataset.option]=t.value;return result}function setStatus(newStatus){status=newStatus,updateButtons()}async function updateButtons(){const state=status.state,isConnected=state===sync_util.connected,off=state===sync_util.disconnected,drv=status.drive;drv&&(elCloud.value=drv),elCloud.disabled=!off,elToggle.disabled=status.syncing,elToggle.textContent=util.t("optionsSync"+(off?"Connect":"Disconnect")),elToggle.dataset.cmd=off?"start":"stop",elSyncNow.disabled=!isConnected||status.syncing||!status.login,elStatus.textContent=sync_util.getStatusText(status,!0),elLogin.hidden=!isConnected||status.login;for(const e of elDriveOptions)e.hidden=e.dataset.drive!==elCloud.value,e.disabled=!off;dom.$toggleDataset(elSync,"enabled","none"!==elCloud.value),syncOpts??=await msg_api.API.sync.getDriveOptions(elCloud.value);for(const t of e())t.value=syncOpts[t.dataset.option]||"";syncOpts=null}elCloud.append(...Object.entries(sync_util.DRIVE_NAMES).map(([e,name])=>dom.$create("option",{value:e},name))),updateButtons(),msg.onMessage.set(e=>{"syncStatusUpdate"===e.method&&setStatus(e.status)}),elCloud.on("change",updateButtons),elToggle.onclick=async()=>{"start"===elToggle.dataset.cmd?(await msg_api.API.sync.setDriveOptions(elCloud.value,getDriveOptions()),await msg_api.API.sync.start(elCloud.value)):await msg_api.API.sync.stop()},elSyncNow.onclick=msg_api.API.sync.syncNow,elLogin.onclick=async()=>{await msg_api.API.sync.login(),await msg_api.API.sync.syncNow()}})();localization.tBody(),n.querySelectorAll("input[min], input[max]").forEach(function(element){const min=Number(element.min),max=Number(element.max),doNotify=()=>element.dispatchEvent(new Event("change",{bubbles:!0})),onChange=({type})=>{"input"===type&&element.checkValidity()?doNotify():"change"!==type||element.checkValidity()||(element.value=util.clamp(Number(element.value),min,max),doNotify())};element.on("change",onChange),element.on("input",onChange)}),n.querySelector("#FOUC .items").textContent=util.t("optionFOUCMV3").replace("<a>",util.t("optionsAdvancedStyleViaXhr")).replace("<b>",util.t("optionKeepAlive")),n.getElementById("keepAlive").previousElementSibling.firstChild.textContent+=(/^(zh|ja|ko)/.test(o.lang)?"":" ")+util.t("optionKeepAlive2").trim();for(const e of n.querySelectorAll("[show-if]"))prefs.subscribe(e.getAttribute("show-if").match(/[.\w]+/)[0],toggleShowIf,!0);t.on("keydown",event=>{"Escape"===dom_util.getEventKeyName(event)&&tellTopToCloseOptions()}),n.querySelector("header i").onclick=tellTopToCloseOptions,n.getElementById("manage").onclick=()=>{msg_api.API.openManager()},n.getElementById("manage.newUI.favicons").onclick=()=>{msg_api.API.prefsDB.delete("badFavs")},n.getElementById("shortcuts").onclick=()=>{msg_api.API.openURL({url:(a.OPERA?"opera://settings":"chrome://extensions")+"/configureCommands"})},n.getElementById("shortcuts").hidden=a.FIREFOX&&!browser.commands?.update,n.getElementById("reset").onclick=async()=>{if(await dom_util.messageBox.confirm(util.t("confirmDiscardChanges")))for(const e of n.querySelectorAll("input")){const t=e.id||e.name;prefs.knownKeys.includes(t)&&prefs.reset(t)}};for(const e of n.querySelectorAll("[data-clickable]")){const value=e.dataset.clickable,t=e.textContent.match(new RegExp(`^(.*\\W)(${value})(?=\\W)(.*)`));if(!t)continue;const input=e.closest("label").$("input"),span=dom.$create("span.clickable",{onclick:()=>dom_util.setInputValue(input,value)},t[2]);e.firstChild.replaceWith(t[1],span,t[3])}function toggleShowIf(key,val){for(const e of n.querySelectorAll(`[show-if*="${key}"]`)){const[,not,t,n,opVal]=e.getAttribute("show-if").match(/^(!?)([.\w]+)(!?=)?(.*)/);t===key&&e.classList.toggle("disabled",!(not?!val:n?"="===n?val==opVal:val!=opVal:val))}}function tellTopToCloseOptions(){top.closeOptions()}(async()=>{const{wrb}=prefs.clientData;if(dom_util.setupLivePrefs(),!1===wrb)for(let e of n.querySelectorAll("#patchCsp"))e=e.closest("label"),e.classList.add("disabled"),e.$(".icon").after(dom.$create("a.broken[data-cmd=note]",{tabIndex:0,title:util.t("webRequestBlockingMV3Note",`<code>${chrome.runtime.id}</code>`)},"âš’"));"#sync-styles"===location.hash&&n.querySelector(".cloud-name").focus()})()}},e=>{e.O(0,["common-ui","css_global-dark_css-css_global_css-css_spinner_css"],()=>e(e.s=9132));e.O()}])}