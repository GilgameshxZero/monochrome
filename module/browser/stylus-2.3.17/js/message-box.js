"use strict";{const e=self,s=e,t=e.document;(self.webpackChunkStylus=self.webpackChunkStylus||[]).push([["js_dlg_message-box_js"],{7239:(e,o,i)=>{i.r(o),o.alert=function(contents,className,title){return new MessageBox({title,contents,className:`center ${className||""}`,buttons:[a.t("confirmClose")]}).open()},o.confirm=async function(contents,className,title){const res=await new MessageBox({title,contents,className:`center ${className||""}`,buttons:[a.t("confirmYes"),a.t("confirmNo")]}).open();return 0===res.button||res.enter},o.pauseAll=pauseAll,o.show=function(params){return new MessageBox(params).open(params.onshow)};var n=i(7986),l=i(3831),c=i(7501),a=i(6940);const boxes=new Set;function pauseAll(paused=!0){for(const e of boxes)e.paused=paused}class MessageBox{el=null;originalFocus=null;paused=!1;#e=null;#s=!1;#t=null;#o=0;#i=0;#n=0;#l=0;constructor({title,contents,className="",buttons=[],blockScroll}){this.#e=blockScroll,this.el=n.$create("div",{id:"message-box",className},[n.$create("div",[n.$create("#message-box-title.ellipsis",{on:{mousedown:this}},title),n.$create("#message-box-close-icon",{on:{click:this.#c.bind(this,{button:-1})}},n.$create("i.i-close")),n.$create("#message-box-contents",c.tHTML(contents)),n.$create("#message-box-buttons",buttons.filter(Boolean).map((btn,buttonIndex)=>("button"!==btn.localName&&(btn=n.$create("button",btn)),btn.buttonIndex=buttonIndex,btn.on("click",this.#c.bind(this,{button:buttonIndex})),btn)))])])}open(onshow){const e=this.el;return t.body.appendChild(e),s.on("keydown",this,!0),this.#e&&(s.on("scroll",this,{passive:!1}),this.#e={x:scrollX,y:scrollY}),boxes.delete(this),pauseAll(),this.paused=!1,boxes.add(this),this.originalFocus=t.activeElement,"_blank"===l.moveFocus(e,0)?.target&&e.classList.contains("config-dialog")&&l.moveFocus(e,1),t.activeElement===this.originalFocus&&t.body.focus(),"function"==typeof onshow&&onshow.call(this,e),new Promise(resolve=>{this.#t=resolve})}async close(isAnimated){this.#t&&(this.el.contains(t.activeElement)&&this.originalFocus.focus(),this.#t=this.originalFocus=null,s.off("keydown",this,!0),s.off("scroll",this),s.off("mouseup",this),s.off("mousemove",this),boxes.delete(this),pauseAll(!1),this.paused=!0,isAnimated&&await l.animateElement(this.el,"fadeout"),this.el.remove())}#c(value){this.#t&&(setTimeout(this.#t,0,value),this.close(!0))}handleEvent(evt){if(!this.paused)switch(evt.type){case"keydown":return this.#a(evt);case"mousedown":return this.#r(evt);case"mousemove":return this.#u(evt);case"mouseup":return this.#h(evt);case"scroll":return this.#f(evt)}}#a(evt){const{key,shiftKey,ctrlKey,altKey,metaKey,target}=evt;if(!(shiftKey&&"Tab"!==key||ctrlKey||altKey||metaKey)){switch(key){case"Enter":if(l.closestFocusable(target))return;break;case"Escape":evt.preventDefault(),evt.stopPropagation();break;case"Tab":return l.moveFocus(this.el,shiftKey?-1:1),void evt.preventDefault();default:return}this.#c("Enter"===key?{enter:!0}:{esc:!0})}}#r(evt){evt.button||(this.#s||(s.on("mouseup",this,{passive:!0}),s.on("mousemove",this,{passive:!0}),this.#s=!0),this.#o=evt.clientX-this.#n,this.#i=evt.clientY-this.#l)}#h(evt){0===evt.button&&(s.off("mouseup",this),s.off("mousemove",this),this.#s=!1)}#u(evt){this.#n=a.clamp(evt.clientX,30,innerWidth-30)-this.#o,this.#l=a.clamp(evt.clientY,30,innerHeight-30)-this.#i,this.el.firstChild.style.transform=`translate(${this.#n}px,${this.#l}px)`}#f(){scrollTo(this.#e.x,this.#e.y)}}o.MessageBox=MessageBox}}])}